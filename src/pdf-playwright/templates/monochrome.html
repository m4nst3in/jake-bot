<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{title}}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    {{styles}}
  </style>
</head>
<body>
  <div class="container">
    <!-- COVER -->
    <section class="cover page-break">
      <div class="title">
        <div class="brand">Relatório Corporativo</div>
        <div class="divider"></div>
        <div class="subtitle small muted">{{areaName}} • {{date}} • v{{version}}</div>
      </div>
    </section>

    <!-- METHODOLOGY (concise) -->
    <section class="section card pad">
      <div class="h2">Metodologia</div>
      <div class="hr"></div>
      <p>Os resultados aqui apresentados são coletados de nossas bases de dados internas. As métricas principais incluem:</p>
      <ul>
        <li><strong>Pontos</strong>: soma ponderada das atividades realizadas.</li>
        {{#if isSupport}}
        <li><strong>Relatórios</strong> e <strong>Plantões</strong> (metas específicas para Suporte).</li>
        {{else}}
        <li><strong>Participação</strong>: comparativo percentual em relação ao líder.</li>
        {{/if}}
      </ul>
      <p class="small muted">Observação: metas e limiares de cargo são interpretados conforme a configuração vigente.</p>
    </section>

    <!-- WEEKLY SUMMARY (full page) -->
    <section class="section card pad full">
      <div class="h2">Resumo da Semana</div>
      <div class="hr"></div>
      <div class="stats">
        <div class="stat">
          <div class="value">{{totalParticipants}}</div>
          <div class="label">Participantes</div>
        </div>
        <div class="stat">
          <div class="value">{{totalPoints}}</div>
          <div class="label">Total de Pontos</div>
        </div>
        <div class="stat">
          <div class="value">{{avgPoints}}</div>
          <div class="label">Média</div>
        </div>
        <div class="stat">
          <div class="value">{{medianPoints}}</div>
          <div class="label">Mediana</div>
        </div>
      </div>

      <div class="hr"></div>
      <div class="grid2">
        <div class="card pad">
          <div class="h3">Destaques</div>
          <div class="hr"></div>
          <ul class="small">
            {{#each topParticipants}}
              {{#if @first}}
                <li><strong>Top 1:</strong> {{username}} — {{points}} pts ({{percentage}}% do total)</li>
              {{/if}}
            {{/each}}
            <li>Total de participantes ranqueados: {{totalParticipants}}</li>
            <li>Pontuação máxima individual: {{maxPoints}}</li>
          </ul>
        </div>
        <div class="card pad">
          <div class="h3">Notas Operacionais</div>
          <div class="hr"></div>
          <p class="small muted">Semana com foco em estabilidade e consistência. Recomenda-se manter o ritmo e reforçar a comunicação de metas aos membros com baixa atividade.</p>
          <p class="small">Metas e critérios permanecem inalterados durante o período considerado.</p>
        </div>
      </div>

      <div class="hr"></div>
      <div class="grid2">
        <div class="card pad">
          <div class="h3">Distribuição</div>
          <div class="hr"></div>
          <p class="small muted">A distribuição de pontos segue concentração nos 10 primeiros colocados, sugerindo espaço para programas de incentivo aos demais membros.</p>
        </div>
        <div class="card pad">
          <div class="h3">Próximos Passos</div>
          <div class="hr"></div>
          <ul class="small">
            <li>Reforçar alinhamento de metas individuais.</li>
            <li>Promover feedbacks objetivos e semanais.</li>
            <li>Identificar membros com potencial de crescimento.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- TOP 10 TABLE -->
    <section class="section card pad">
      <div class="h2">Top 10 Participantes</div>
      <div class="hr"></div>
      <table class="table">
        <thead>
          <tr>
            <th>Pos</th>
            <th>Usuário</th>
            <th>Pontos</th>
            <th>% Total</th>
            {{#if isSupport}}
            <th>Relatórios</th>
            <th>Plantões</th>
            {{else}}
            <th>Participação</th>
            {{/if}}
          </tr>
        </thead>
        <tbody>
          {{#each topParticipants}}
          <tr>
            <td>{{add @index 1}}</td>
            <td>{{username}}</td>
            <td>{{points}}</td>
            <td>{{percentage}}%</td>
            {{#if isSupport}}
            <td>{{reports}}</td>
            <td>{{shifts}}</td>
            {{else}}
            <td>{{participation}}</td>
            {{/if}}
          </tr>
          {{/each}}
        </tbody>
      </table>
    </section>

    <!-- DETAILED ANALYSIS -->
    <section class="section">
      <div class="card pad">
        <div class="h2">5. Análise Detalhada</div>
        <div class="hr"></div>
        <div class="grid2">
          {{#each participants}}
          <div class="card person">
            <div class="head">
              {{#if avatar}}
              <img src="{{avatar}}" alt="Avatar" class="avatar-img" />
              {{else}}
              <div class="avatar">{{initials}}</div>
              {{/if}}
              <div>
                <div class="h3">{{username}}</div>
                <div class="meta">ID: {{userId}}</div>
              </div>
              <div class="badge" style="margin-left:auto;">{{#if metGoals}}Meta Cumprida{{else}}Meta Não Cumprida{{/if}}</div>
            </div>
            <div class="hr"></div>
            <div class="score">
              <div>◆</div>
              <div class="pts">{{points}} pontos</div>
              {{#if rank}}
              <div class="tag" style="margin-left: 6px;">{{rank}}</div>
              {{/if}}
            </div>
            <div class="hr"></div>
            <div class="list">
              {{#if isSupport}}
                <div class="item"><div class="ic">{{pointsIcon}}</div><div>Meta Pontos: {{pointsGoal}} {{#unless pointsGoalMet}}(faltam {{pointsNeeded}}){{/unless}}</div></div>
                {{#if reportsGoal}}
                  <div class="item"><div class="ic">{{reportsIcon}}</div><div>Relatórios: {{reports}}/{{reportsGoal}} {{#unless reportsGoalMet}}(faltam {{reportsNeeded}}){{/unless}}</div></div>
                {{/if}}
                <div class="item"><div class="ic">{{shiftsIcon}}</div><div>Plantões: {{shifts}}/{{shiftsGoal}} {{#unless shiftsGoalMet}}(faltam {{shiftsNeeded}}){{/unless}}</div></div>
              {{/if}}
              {{#if isNonSupport}}
                {{#if goal}}
                  <div class="item"><div class="ic">{{goalIcon}}</div><div>Meta: {{goal}} {{#unless goalMet}}(faltam {{goalNeeded}}){{/unless}}</div></div>
                {{/if}}
              {{/if}}
            </div>
          </div>
          {{/each}}
        </div>
      </div>
    </section>

    <div class="footer">
      <div>Relatório • {{areaName}}</div>
      <div>Página {{pageNumber}}</div>
    </div>
  </div>
</body>
</html>
